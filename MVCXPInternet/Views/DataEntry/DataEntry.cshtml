@{
    ViewBag.Title = "Index";
}
<style type="text/css">
    #dataEntryApp
    {
        color: #333333;
        font-family: "Segoe UI" ,Verdana,Helvetica,Sans-Serif; /*font-size: 0.85em;*/
        margin: 0;
        padding: 0;
    }
    
    #dataEntryApp table
    {
        margin: 0em;
        border: 0 none;
        border-collapse: collapse;
        border-spacing: 0;
    }
    
    #recordListingContainer
    {
        background-color: #FFF;
        border: solid 1px #AAA;
        height: 500px;
        overflow: auto;
    }
    
    #recordListing
    {
        margin-top: 0px;
    }
    
    #recordListing th, #recordListing td
    {
        border: solid 1px #CCC;
        margin: 0px;
    }
    
    #recordListing th
    {
        background-color: #DDD;
        padding: 5px 2px;
        font-size: 1.0em;
        font-weight: normal; /*padding: 0.25em; background-color: #FFF;*/
        text-align: center;
    }
    
    #recordListing tr.record td
    {
        background-color: #FFF;
        padding: 3px;
        text-align: center;
    }
    
    #dataFieldInfoContainer
    {
        /*
        border: solid 1px #AAA;
        border-top-width: 0px;
        border-bottom-width: 0px;
        */
        border: solid 5px #5873a7;
        border-top-width: 0px;
        margin: 0px;
        padding: 15px;
        background-color: #EEE;
        min-height: 215px;
    }
    
    
    #dataFieldInfoContainer .optionscontainer
    {
    }
    
    #dataFieldInfoContainer .optionscontainer .option
    {
        border: solid 1px #5873a7;
        background-color: #cfdefc;
        padding: 0px;
        margin: 2px;
        float: left;
        width: 450px;
    }
    
    #dataFieldInfoContainer .optionscontainer .option.selected
    {
        border: solid 1px #224992;
        background-color: #4268af;
        color: #FFF;
    }
    
    #dataFieldInfoContainer .optionscontainer .option table
    {
        margin: 0px;
    }
    
    #dataFieldInfoContainer .optionscontainer .option .optionKey
    {
        width: 15px;
        font-weight: bold;
        font-size: 1.1em;
        vertical-align: middle;
        padding: 5px;
    }
    #dataFieldInfoContainer .optionscontainer .option .optionLabel
    {
        padding: 0px;
        vertical-align: middle;
    }
    
    
    #dataFieldInfoContainer #currentFieldPreview
    {
        font-size: 1.1em;
        font-weight: bold;
        padding: 2px; /*display:none;*/
    }
    
    #dataFieldInfoContainer #currentFieldPreview .fieldLabel
    {
    }
    
    #dataFieldInfoContainer #currentFieldPreview .fieldValue
    {
    }
    
    #editorContainer
    {
        background-color: #DDD;
        color: #333;
    }
    
    #editorContainer table tr td
    {
        padding: 0em;
        margin: 0em;
        border: solid 1px #AAA;
        text-align: center;
    }
    
    #editorContainer tr.labels td
    {
        padding: 0.25em;
    }
    
    #editorContainer tr.labels td.currentField
    {
        background-color: #eee;
        border-top-width: 0px; /*background-color: #cfdefc;*/ /*border-color: #5873a7;*/
    }
    
    #editorContainer tr.controls td
    {
        /*border-top-width:0px;*/
        background-color: #fff;
        text-align: left;
        border-bottom: solid 5px #5873a7;
    }
    
    #editorContainer tr.controls td.invalid
    {
        border-bottom: solid 5px Red;
        color: Red;
    }
    
    
    
    #editorContainer tr.controls td.currentField
    {
        background-color: #fff; /*border: solid 0px #5873a7;*/
        font-weight: bold;
        border: solid 5px #5873a7;
        border-bottom-width: 0px;
    }
    
    #editorContainer input
    {
        width: 35px;
        color: #476296;
        font-size: 1.2em;
        margin: 0px;
        padding: 5px;
        background-color: transparent;
        border-style: none;
    }
    
    span.invalid, #editorContainer input.invalid
    {
        color: Red;
    }
    
    #editorContainer input.datepicker
    {
        width: 90px !important;
    }
    
    #editorContainer input[type=button]
    {
        padding: 5px 0px;
        width: 25px !important;
        border: solid 1px #AAA;
        background-color: #DDD;
    }
    
    #editorContainer input[type=button]:focus
    {
        border: solid 1px #224992;
        background-color: #cfdefc;
    }
    
    
    #errors
    {
        color: Maroon;
        border: solid 1px #FAA;
        background-color: #FEE;
        padding: 10px;
        margin-top: 10px;
        display: none;
    }
    
    #outputConsole
    {
        position: absolute;
        top: 20px;
        left: 10px;
        width: 240px;
        border: solid 1px #CCC;
        padding: 5px;
        background-color: #333;
        color: lightgreen;
    }
</style>
<h2>
    Data Entry - Dynamic form</h2>
<div id="dataEntryApp">
    <div id="errors">
    </div>
    <div style="text-align: right">
        <h4>
            Processed : <span data-bind="text: ProcessedRecords().length"></span>&nbsp;/&nbsp;<span
                data-bind="text: Records().length"></span>&nbsp;Pending : <span data-bind="text: PendingRecords().length">
                </span>&nbsp;/&nbsp;<span data-bind="text: Records().length"></span></h4>
    </div>
    <div id="recordListingContainer">
        <table id="recordListing" cellpadding="2" cellspacing="0" border="1" width="100%">
            <thead>
                <tr>
                    <!-- ko foreach: Draft.Fields -->
                    <th data-bind="text: Label">
                    </th>
                    <!-- /ko -->
                    <th>
                        Status
                    </th>
                </tr>
            </thead>
            <tbody data-bind="foreach: Records">
                <tr class="record">
                    <!-- ko foreach: Fields -->
                    <td>
                        <span data-bind="text: EffectiveValue"></span>
                        <br />
                    </td>
                    <!-- /ko -->
                    <td>
                        <span data-bind="text: Status"></span>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
    <div id="editorContainer">
        <table cellpadding="0" cellspacing="0" border="0" width="100%">
            <tr class="labels" style="display: none;">
                <!-- ko foreach: Draft.Fields -->
                <td data-bind="text: Label, css:{currentField: HasFocus, invalid: IsInputInvalid}">
                </td>
                <!-- /ko -->
                <td>
                    &nbsp;
                </td>
            </tr>
            <tr class="controls">
                <!-- ko foreach: Draft.Fields -->
                <td data-bind="css:{currentField: HasFocus, invalid: IsInputInvalid}">
                    <input type="text" data-bind="value: Input, valueUpdate: 'keyup', hasfocus : HasFocus, attr:{class: Interface},css:{currentField: HasFocus, invalid: IsInputInvalid}, event: { blur: AutoAdjust}" />
                </td>
                <!-- /ko -->
                <td>
                  <input id="saveButton" type="button" value="Save" />
                </td>
            </tr>
        </table>
    </div>
    <div id="dataFieldInfoContainer">
        <div class="optionscontainer">
            <!-- ko foreach: Draft.Fields -->
            <div id="currentFieldPreview" data-bind="visible: HasFocus">
                <span class="fieldLabel" data-bind="text: Label"></span>: <span class="fieldValue invalid"
                    data-bind="visible: IsInputInvalid, text: WhyInvalid"></span><span class="fieldValue"
                        data-bind="visible: !IsInputInvalid(), text: Input"></span>
            </div>
            <div class="fieldOptions" data-bind="visible: HasFocus">
                <!-- ko foreach: Options -->
                <div class="option" data-bind="css: { selected: Selected }">
                    <table width="100%" border="0" cellpadding="0" cellspacing="0">
                        <tr>
                            <td class="optionKey">
                                <span data-bind="text: Value"></span>
                            </td>
                            <td class="optionLabel">
                                <span data-bind="text: Label"></span>
                            </td>
                        </tr>
                    </table>
                </div>
                <!-- /ko -->
                <br style="clear: both;" />
            </div>
            <!-- /ko -->
        </div>
    </div>
</div>
<div data-bind="text: ko.toJSON(Draft.Fields)"></div>

<div id="outputConsole">
    <ul id="messages">
    </ul>
</div>
@section scripts {
    <script src="@Url.Content("~/Scripts/json2.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery-1.8.0.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery-ui-1.8.23.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/jquery.signalR-0.5.3.min.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/signalr/hubs")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/knockout-2.1.0.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/knockout.mapping-latest.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/linq.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/dataentry.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/dataentry2view.js")" type="text/javascript"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $(".datepicker").datepicker(
            {
                onClose: function () {this.focus();}
            });
        });
    </script>
}

